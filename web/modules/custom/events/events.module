<?php
use Drupal\Core\Form\FormStateInterface;

/**
 * Implements hook_form_FORM_ID_alter().
 */
function events_form_node_main_events_form_alter(&$form, FormStateInterface $form_state, $form_id) {
  $form['#validate'][] = 'events_main_events_date_validate';
}

/**
 * Custom validation handler to ensure end date is after start date.
 */
function events_main_events_date_validate(array &$form, FormStateInterface $form_state) {
  $start = $form_state->getValue('field_start_date')[0]['value'] ?? null;
  $end = $form_state->getValue('field_end_date')[0]['value'] ?? null;

  if (!empty($start) && !empty($end)) {
    $start_time = strtotime($start);
    $end_time = strtotime($end);

    if ($end_time <= $start_time) {
      $form_state->setErrorByName('field_end_date', t('End date must be after the start date.'));
    }
  }
}
